package cn.totorotec.service.security;

import cn.totorotec.entity.Operation;
import cn.totorotec.entity.Role;
import cn.totorotec.entity.Session;
import cn.totorotec.entity.User;

public interface SupportingSystem {

    /**
     * The session parameter, which represents the session identifier,
     * is actually generated by the underlying system.
     *
     *
     * @param user
     * @param session
     * @return
     */
    Session createSession(User user, String session);

    Session deleteSession(User user, String session);

    /**
     *
     * @param user
     * @param session
     * @param role
     */
    void addActiveRole(User user, Session session, Role role);

    /**
     *
     * @param user
     * @param session
     * @param role
     */
    void dropActiveRole(User user, Session session, Role role);

    /**
     * 权限检查, 核心接口
     *
     * @param session
     * @param operation
     * @param object
     * @return
     */
    Boolean checkAccess(Session session, Operation operation, Object object);
}
